{% extends 'base.html' %}
{% block content %}
  <h2>Your Bookings</h2>
  {% if cancelled %}
    <div style="background: #eafbe7; color: #1a8000; padding: 10px; border-radius: 8px; margin-bottom: 16px;">
      Booking cancelled successfully.
    </div>
  {% endif %}
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Room</th>
        <th>Check-in</th>
        <th>Check-out</th>
        <th>Status</th>
        <th>Guests</th>
        <th>Amount</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for booking in bookings %}
      <tr>
        <td>{{ booking.id }}</td>
        <td>{{ booking.room }}</td>
        <td>{{ booking.check_in_date }}</td>
        <td>{{ booking.check_out_date }}</td>
        <td>{{ booking.status }}</td>
        <td>{{ booking.num_guests }}</td>
        <td>{{ booking.total_amount }} {{ booking.currency }}</td>
        <td>
          <a href="{% url 'booking-detail' booking.id %}">View</a>
          {% if booking.status == 'confirmed' %}
            <a href="{% url 'booking-update' booking.id %}">Edit</a>
            <form method="post" style="display:inline;">
              {% csrf_token %}
              <input type="hidden" name="cancel_booking_id" value="{{ booking.id }}">
              <button type="submit" onclick="return confirm('Are you sure you want to cancel this booking?');">Cancel</button>
            </form>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="8">No bookings found.</td></tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
