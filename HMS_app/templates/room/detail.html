{% extends "base.html" %}
{% block head %}
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/room/detail.css' %}">
{% endblock %}

{% block content %}
    <section class="room-detail-hero">
        <h1 class="room-title">{{ room.type }}</h1>
    </section>

    <section class="room-detail-main two-col">
        <div class="left-col">
            <div class="room-detail-card">
                <div class="room-detail-info">
                    <div class="room-detail-price">${{ room.price }} <span class="per-night">/ night</span></div>
                    <div class="room-detail-occupancy">Max Occupancy: <strong>{{ room.max_occupancy }}</strong></div>
                </div>
                <div class="room-detail-gallery">
                    {% for image in images %}
                        <img src="{{ image.image_url }}" alt="Room Image" class="room-detail-image">
                    {% empty %}
                        <p>No images available.</p>
                    {% endfor %}
                </div>
            </div>
        </div>
        <aside class="right-col">
            <div class="booking-panel">
                <h2>Reserve this room</h2>
                {% if available_today > 0 %}
                    <form method="post" action="{% url 'booking-create-for-room' room.id %}" class="booking-form">
                        {% csrf_token %}
                        {{ booking_form.room.as_hidden }}
                                                {% if booking_form.non_field_errors %}
                                                    <div class="form-errors">
                                                        {% for err in booking_form.non_field_errors %}
                                                            <p class="error">{{ err }}</p>
                                                        {% endfor %}
                                                    </div>
                                                {% endif %}
                        <div class="form-group">{{ booking_form.check_in_date.label_tag }} {{ booking_form.check_in_date }}</div>
                                                {% if booking_form.check_in_date.errors %}
                                                    <div class="error">{{ booking_form.check_in_date.errors.0 }}</div>
                                                {% endif %}
                        <div class="form-group">{{ booking_form.check_out_date.label_tag }} {{ booking_form.check_out_date }}</div>
                                                {% if booking_form.check_out_date.errors %}
                                                    <div class="error">{{ booking_form.check_out_date.errors.0 }}</div>
                                                {% endif %}
                        <div class="form-group">{{ booking_form.num_guests.label_tag }} {{ booking_form.num_guests }}</div>
                                                {% if booking_form.num_guests.errors %}
                                                    <div class="error">{{ booking_form.num_guests.errors.0 }}</div>
                                                {% endif %}
                        <button type="submit" class="btn submit">Book Now</button>
                    </form>
                {% else %}
                    <button class="btn submit room-detail-cta" disabled>Fully Booked</button>
                {% endif %}
            </div>
        </aside>
    </section>
    
    <section class="hotel-services">
        <h2>Services</h2>
        <div class="services-grid">
            {% for service in services %}
                <div class="service-card">
                    <a href="{% url 'service-detail' service.id %}">
                        {% if service.image %}
                            <img src="{{ service.image }}" alt="{{ service.name }}" />
                        {% endif %}
                        <div class="service-body">
                            <h3>{{ service.name }}</h3>
                            <div class="price">{{ service.price }} {{ service.currency }}</div>
                        </div>
                    </a>
                </div>
            {% empty %}
                <p>No services available.</p>
            {% endfor %}
        </div>
    </section>
{% endblock %}